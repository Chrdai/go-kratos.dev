"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2844],{3905:function(e,r,t){t.d(r,{Zo:function(){return u},kt:function(){return m}});var n=t(7294);function i(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){i(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(i[t]=e[t]);return i}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var d=n.createContext({}),c=function(e){var r=n.useContext(d),t=r;return e&&(t="function"==typeof e?e(r):o(o({},r),e)),t},u=function(e){var r=c(e.components);return n.createElement(d.Provider,{value:r},e.children)},s={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},p=n.forwardRef((function(e,r){var t=e.components,i=e.mdxType,a=e.originalType,d=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(t),m=i,v=p["".concat(d,".").concat(m)]||p[m]||s[m]||a;return t?n.createElement(v,o(o({ref:r},u),{},{components:t})):n.createElement(v,o({ref:r},u))}));function m(e,r){var t=arguments,i=r&&r.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=p;var l={};for(var d in r)hasOwnProperty.call(r,d)&&(l[d]=r[d]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var c=2;c<a;c++)o[c]=t[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,t)}p.displayName="MDXCreateElement"},6204:function(e,r,t){t.r(r),t.d(r,{frontMatter:function(){return l},contentTitle:function(){return d},metadata:function(){return c},toc:function(){return u},default:function(){return p}});var n=t(3117),i=t(102),a=(t(7294),t(3905)),o=["components"],l={id:"overview",title:"Overview"},d=void 0,c={unversionedId:"component/middleware/overview",id:"component/middleware/overview",title:"Overview",description:"Kratos has a series of built-in middleware to deal with common purpose such as logging or metrics. You could also implement Middleware interface to develop your custom middleware to process common business such as the user authentication etc.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/component/middleware/01-overview.md",sourceDirName:"component/middleware",slug:"/component/middleware/overview",permalink:"/en/docs/component/middleware/overview",editUrl:"https://github.com/go-kratos/go-kratos.dev/edit/main/i18n/en/docusaurus-plugin-content-docs/current/component/middleware/01-overview.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"overview",title:"Overview"},sidebar:"docs",previous:{title:"Routing and Load Balancing",permalink:"/en/docs/component/selector"},next:{title:"Authentication",permalink:"/en/docs/component/middleware/auth"}},u=[{value:"Built-in Middleware",id:"built-in-middleware",children:[{value:"logging",id:"logging",children:[],level:3},{value:"metrics",id:"metrics",children:[],level:3},{value:"recovery",id:"recovery",children:[],level:3},{value:"status",id:"status",children:[],level:3},{value:"tracing",id:"tracing",children:[],level:3},{value:"validate",id:"validate",children:[],level:3},{value:"auth",id:"auth",children:[],level:3},{value:"ratelimit",id:"ratelimit",children:[],level:3},{value:"circuitbreaker",id:"circuitbreaker",children:[],level:3}],level:2},{value:"Usage",id:"usage",children:[],level:2},{value:"Custom Middleware",id:"custom-middleware",children:[],level:2}],s={toc:u};function p(e){var r=e.components,t=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,n.Z)({},s,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Kratos has a series of built-in middleware to deal with common purpose such as logging or metrics. You could also implement Middleware interface to develop your custom middleware to process common business such as the user authentication etc."),(0,a.kt)("h2",{id:"built-in-middleware"},"Built-in Middleware"),(0,a.kt)("p",null,"Their codes are located in ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware")," directory."),(0,a.kt)("h3",{id:"logging"},"logging"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/logging"),", this middleware is for logging the request."),(0,a.kt)("h3",{id:"metrics"},"metrics"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/metrics"),", this middleware is for enabling metric."),(0,a.kt)("h3",{id:"recovery"},"recovery"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/recovery"),"\uff0c, this middleware is for panic recovery."),(0,a.kt)("h3",{id:"status"},"status"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/status"),", this middleware is for transformation of gRPC error."),(0,a.kt)("h3",{id:"tracing"},"tracing"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/tracing"),", this middleware is for enabling trace."),(0,a.kt)("h3",{id:"validate"},"validate"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/validate"),", this middleware is for parameter validation."),(0,a.kt)("h3",{id:"auth"},"auth"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/auth"),", this middleware is for authority check using JWT."),(0,a.kt)("h3",{id:"ratelimit"},"ratelimit"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/ratelimit"),", this middleware is for traffic control in server side."),(0,a.kt)("h3",{id:"circuitbreaker"},"circuitbreaker"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"middleware/circuitbreaker"),", this middleware is for breaker control in client side."),(0,a.kt)("h2",{id:"usage"},"Usage"),(0,a.kt)("p",null,"Register it with ",(0,a.kt)("inlineCode",{parentName:"p"},"ServerOption")," in ",(0,a.kt)("inlineCode",{parentName:"p"},"NewGRPCServer")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"NewHTTPServer"),"."),(0,a.kt)("p",null,"For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"// http\n// define opts\nvar opts = []http.ServerOption{\n    http.Middleware(\n        recovery.Recovery(),\n        tracing.Server(),\n        logging.Server(),\n    ),\n}\n// create server\nhttp.NewServer(opts...)\n\n\n\n//grpc\nvar opts = []grpc.ServerOption{\n        grpc.Middleware(\n            recovery.Recovery(),\n            status.Server(),\n            tracing.Server(),\n            logging.Server(),\n        ),\n    }\n// create server\ngrpc.NewServer(opts...)\n\n")),(0,a.kt)("h2",{id:"custom-middleware"},"Custom Middleware"),(0,a.kt)("p",null,"Implement ",(0,a.kt)("inlineCode",{parentName:"p"},"Middleware")," interface."),(0,a.kt)("p",null,"(TBD)"))}p.isMDXComponent=!0}}]);